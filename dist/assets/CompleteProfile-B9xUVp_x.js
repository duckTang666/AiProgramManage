import{a as v,r as d,C as b,k as g,b as n,f as e,D as w,e as m,w as p,v as c,t as f,z as h,o as u,A as _}from"./vue-B0LylYIL.js";import{u as k,U as C}from"./index-Dhaj8LKV.js";import"./supabase-DqT9qdmq.js";const V={class:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8"},z={class:"max-w-md w-full space-y-8"},S={class:"rounded-md shadow-sm -space-y-px"},U={key:0,class:"text-red-600 text-sm text-center"},B=["disabled"],D={key:0,class:"absolute left-0 inset-y-0 flex items-center pl-3"},j=v({__name:"CompleteProfile",setup(M){const y=_(),o=k(),a=d(!1),s=d(""),r=b({display_name:"",email:""});g(()=>{o.user?.email&&(r.email=o.user.email)});async function x(){if(!r.display_name.trim()){s.value="请输入显示名称";return}if(!r.email.trim()){s.value="邮箱地址不能为空";return}a.value=!0,s.value="";try{const l={email:r.email,display_name:r.display_name,role:"member",is_active:!0};await C.createUser(l),o.markProfileComplete(),y.push("/")}catch(l){console.error("Complete profile error:",l),s.value=l.message||"保存失败，请重试"}finally{a.value=!1}}return(l,t)=>(u(),n("div",V,[e("div",z,[t[5]||(t[5]=e("div",null,[e("h2",{class:"mt-6 text-center text-3xl font-extrabold text-gray-900"}," 完善个人信息 "),e("p",{class:"mt-2 text-center text-sm text-gray-600"}," 请完善您的个人信息以继续使用系统 ")],-1)),e("form",{class:"mt-8 space-y-6",onSubmit:w(x,["prevent"])},[e("div",S,[e("div",null,[t[2]||(t[2]=e("label",{for:"display-name",class:"sr-only"},"显示名称",-1)),p(e("input",{id:"display-name","onUpdate:modelValue":t[0]||(t[0]=i=>r.display_name=i),type:"text",required:"",class:"relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"显示名称"},null,512),[[c,r.display_name]])]),e("div",null,[t[3]||(t[3]=e("label",{for:"email",class:"sr-only"},"邮箱地址",-1)),p(e("input",{id:"email","onUpdate:modelValue":t[1]||(t[1]=i=>r.email=i),type:"email",required:"",class:"relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"邮箱地址",readonly:!0},null,512),[[c,r.email]])])]),s.value?(u(),n("div",U,f(s.value),1)):m("",!0),e("div",null,[e("button",{type:"submit",disabled:a.value,class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"},[a.value?(u(),n("span",D,[...t[4]||(t[4]=[e("svg",{class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):m("",!0),h(" "+f(a.value?"保存中...":"完成注册"),1)],8,B)])],32)])]))}});export{j as default};
