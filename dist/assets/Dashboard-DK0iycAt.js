import{a as ie,c as L,r as y,j as K,k as de,b as i,e as x,f as e,t as n,l as A,y as O,p as ce,z as M,n as q,F as R,h as N,A as ue,o as d,B as ge}from"./vue-B0LylYIL.js";import{u as me,a as ve,b as fe,s as g,_ as xe}from"./index-Dhaj8LKV.js";import"./supabase-DqT9qdmq.js";const pe={class:"min-h-screen bg-gray-50"},he={key:0,class:"fixed inset-0 bg-white bg-opacity-80 flex items-center justify-center z-50"},_e={class:"text-center"},ye={key:0,class:"text-sm text-gray-500 mt-2"},be={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mx-4 mt-4"},we={class:"flex items-center"},ke={class:"text-red-700"},ze={class:"bg-white shadow-sm border-b border-gray-200"},Ie={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},je={class:"flex justify-between h-16"},Ce={class:"flex items-center space-x-8"},De={class:"hidden md:flex items-center space-x-4"},Pe={class:"flex items-center space-x-4"},Ee={class:"flex items-center space-x-2"},Me=["src"],Ae={class:"text-sm font-medium text-gray-700"},Oe={key:0,class:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full"},Se=["disabled"],Te={class:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8"},Be={class:"mb-8"},Le={class:"text-3xl font-bold text-gray-900 mb-2"},qe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},Re={class:"card p-6"},Ne={class:"flex items-center"},Ve={class:"text-2xl font-bold text-gray-900"},He={key:0,class:"text-xs text-gray-500 mt-1"},Ue={class:"card p-6"},$e={class:"flex items-center"},Fe={class:"text-2xl font-bold text-gray-900"},Ge={key:0,class:"text-xs text-gray-500 mt-1"},Je={class:"card p-6"},We={class:"flex items-center"},Ke={class:"text-2xl font-bold text-gray-900"},Qe={key:0,class:"text-xs text-gray-500 mt-1"},Xe={class:"card p-6"},Ye={class:"flex items-center"},Ze={class:"text-2xl font-bold text-gray-900"},es={key:0,class:"text-xs text-gray-500 mt-1"},ss={key:0,class:"mb-6"},ts={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},os={class:"lg:col-span-2"},rs={class:"card p-6"},as={class:"flex justify-between items-center mb-6"},ns={class:"space-y-4"},ls={class:"flex justify-between items-start mb-2"},is={class:"font-medium text-gray-900"},ds={class:"text-sm text-gray-600 mb-3"},cs={class:"flex justify-between items-center text-xs text-gray-500"},us={key:0,class:"text-center py-8 text-gray-500"},gs={class:"card p-6 mt-6"},ms={class:"flex justify-between items-center mb-6"},vs={class:"text-sm text-gray-500"},fs={class:"space-y-4"},xs={class:"flex justify-between items-start mb-2"},ps={class:"font-medium text-gray-900"},hs={class:"flex items-center space-x-2"},_s={class:"text-sm text-gray-600 mb-3"},ys={class:"flex justify-between items-center"},bs={class:"flex-1 mr-4"},ws={class:"w-full bg-gray-200 rounded-full h-2"},ks={class:"text-xs text-gray-500"},zs={class:"flex justify-between items-center text-xs text-gray-500 mt-2"},Is={key:0},js={key:0,class:"text-center py-8 text-gray-500"},Cs={class:"space-y-6"},Ds={class:"card p-6"},Ps={class:"space-y-3"},Es={class:"text-sm text-blue-700"},Ms=ie({__name:"Dashboard",setup(As){const P=ue(),l=me(),V=ve();fe();const H=L(()=>p.value?.display_name?p.value.display_name:l.user?.user_metadata?.name||l.user?.email?.split("@")[0]||"ç”¨æˆ·"),Q=L(()=>p.value?.avatar_url||l.user?.user_metadata?.avatar_url||"/default-avatar.png"),U=L(()=>p.value?.role||"member"),p=y(null),a=y({activeProjects:0,pendingTasks:0,organizations:0,aiChats:0}),c=y([]),u=y([]),b=y([]),w=y(!0),k=y(""),f=y(""),S=t=>new Date(t).toLocaleDateString("zh-CN");async function T(){try{const t=l.user?.email;if(!t)return console.log("ç”¨æˆ·é‚®ç®±ä¸ºç©ºï¼Œæ— æ³•æŸ¥è¯¢æ•°æ®åº“ç”¨æˆ·ID"),null;console.log("ðŸ” å¼€å§‹æŸ¥è¯¢æ•°æ®åº“ç”¨æˆ·IDï¼Œé‚®ç®±:",t);const{data:s,error:r}=await g.from("users").select("id").eq("email",t).single();if(!r&&s)return console.log("âœ… é€šè¿‡emailæŸ¥è¯¢åˆ°ç”¨æˆ·ID:",s.id),s.id;console.log("âŒ é€šè¿‡emailæŸ¥è¯¢å¤±è´¥:",r?.message);const{data:o,error:m}=await g.from("users").select("id").limit(1).single();return!m&&o?(console.log("âš ï¸ ä½¿ç”¨å¤‡ç”¨ç”¨æˆ·ID:",o.id),o.id):null}catch(t){return console.error("èŽ·å–æ•°æ®åº“ç”¨æˆ·IDå¤±è´¥:",t),null}}async function X(){try{await l.logout(),P.push("/login")}catch(t){console.error("Logout error:",t)}}async function $(){await C()}async function Y(){f.value="",await C()}function Z(){const t=new CustomEvent("show-ai-chat");window.dispatchEvent(t)}async function ee(){try{P.push("/organizations?action=create")}catch(t){console.error("åˆ›å»ºç»„ç»‡å¤±è´¥:",t),f.value="åˆ›å»ºç»„ç»‡å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ•°æ®åº“è¿žæŽ¥"}}async function se(){try{if(V.organizations.length===0){window.confirm("æ‚¨è¿˜æ²¡æœ‰åŠ å…¥ä»»ä½•ç»„ç»‡ï¼Œæ˜¯å¦çŽ°åœ¨åˆ›å»ºæ–°ç»„ç»‡ï¼Ÿ")&&P.push("/organizations?action=create");return}P.push("/project-management?action=create")}catch(t){console.error("åˆ›å»ºé¡¹ç›®å¤±è´¥:",t),f.value="åˆ›å»ºé¡¹ç›®å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ•°æ®åº“è¿žæŽ¥"}}async function te(){try{const t=l.user?.email;if(!t){console.log("ç”¨æˆ·é‚®ç®±ä¸ºç©ºï¼Œè·³è¿‡ç”¨æˆ·æ¡£æ¡ˆåŠ è½½");return}k.value="æ­£åœ¨åŠ è½½ç”¨æˆ·ä¿¡æ¯...",console.log("ðŸ” å¼€å§‹åŠ è½½ç”¨æˆ·æ¡£æ¡ˆï¼Œé‚®ç®±:",t);const{data:s,error:r}=await g.from("users").select("*").eq("email",t).single();if(r){if(r.code==="PGRST116"||r.message?.includes("does not exist")){console.warn("ç”¨æˆ·è¡¨ä¸å­˜åœ¨ï¼Œè¯·å…ˆæ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–"),p.value={display_name:l.user?.email?.split("@")[0]||"ç”¨æˆ·",role:"member",is_active:!0};return}if(r.code==="PGRST116"){console.warn("ç”¨æˆ·è®°å½•ä¸å­˜åœ¨ï¼Œåˆ›å»ºé»˜è®¤æ¡£æ¡ˆ"),p.value={display_name:l.user?.email?.split("@")[0]||"ç”¨æˆ·",role:"member",is_active:!0};return}throw r}p.value=s,console.log("âœ… ç”¨æˆ·æ¡£æ¡ˆåŠ è½½æˆåŠŸ:",p.value)}catch(t){console.error("åŠ è½½ç”¨æˆ·æ¡£æ¡ˆå¤±è´¥:",t),p.value={display_name:l.user?.email?.split("@")[0]||"ç”¨æˆ·",role:"member",is_active:!0}}}async function oe(){try{const t=l.user?.id,s=l.user?.email;if(!t&&!s){console.log("ç”¨æˆ·IDå’Œé‚®ç®±éƒ½ä¸ºç©ºï¼Œè·³è¿‡æ•°æ®åŠ è½½");return}k.value="æ­£åœ¨åŠ è½½ç»Ÿè®¡æ•°æ®...",console.log("ðŸ” å¼€å§‹åŠ è½½ç»Ÿè®¡æ•°æ®ï¼Œè®¤è¯ID:",t,"é‚®ç®±:",s);const r=await T();if(!r){console.log("æ— æ³•èŽ·å–æ•°æ®åº“ç”¨æˆ·IDï¼Œè·³è¿‡æ•°æ®åŠ è½½"),a.value={activeProjects:0,pendingTasks:0,organizations:0,aiChats:0};return}console.log("âœ… èŽ·å–åˆ°æ•°æ®åº“ç”¨æˆ·ID:",r);const[{data:o,error:m},{data:E,error:z}]=await Promise.all([g.from("organization_members").select("organization_id").eq("user_id",r),g.from("organizations").select("id").eq("owner_id",r)]);if(m&&z){if(console.error("æŸ¥è¯¢ç»„ç»‡å…³ç³»å¤±è´¥:",m,z),m.message?.includes("does not exist")||z.message?.includes("does not exist")){console.warn("ç»„ç»‡ç›¸å…³è¡¨ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤æ•°æ®"),a.value={activeProjects:0,pendingTasks:0,organizations:0,aiChats:0};return}throw m}const h=o?.map(I=>I.organization_id)||[],D=E?.map(I=>I.id)||[],v=[...new Set([...h,...D])];console.log("âœ… ç”¨æˆ·æ‰€å±žç»„ç»‡æ•°é‡:",v.length),console.log("ðŸ“Š ç»„ç»‡è¯¦æƒ…:",{ä½œä¸ºæˆå‘˜çš„ç»„ç»‡:h,ä½œä¸ºæ‰€æœ‰è€…çš„ç»„ç»‡:D,åˆå¹¶åŽçš„ç»„ç»‡:v});let _=0;if(v.length>0){const{data:I,error:j}=await g.from("projects").select("id").in("organization_id",v).eq("status","active");j?(console.error("æŸ¥è¯¢æ´»è·ƒé¡¹ç›®å¤±è´¥:",j),j.message?.includes("does not exist")&&console.warn("projectsè¡¨ä¸å­˜åœ¨ï¼Œè·³è¿‡é¡¹ç›®ç»Ÿè®¡")):_=I?.length||0}let J=0;if(v.length>0){const{data:I,error:j}=await g.from("tasks").select("id").in("status",["todo","in_progress"]);j?(console.error("æŸ¥è¯¢å¾…åŠžä»»åŠ¡å¤±è´¥:",j),j.message?.includes("does not exist")&&console.warn("tasksè¡¨ä¸å­˜åœ¨ï¼Œè·³è¿‡ä»»åŠ¡ç»Ÿè®¡")):J=I?.length||0}let W=0;const{data:le,error:B}=await g.from("chat_history").select("id").eq("user_id",r);B?(console.error("æŸ¥è¯¢AIå¯¹è¯å¤±è´¥:",B),B.message?.includes("does not exist")&&console.warn("chat_historyè¡¨ä¸å­˜åœ¨ï¼Œè·³è¿‡AIå¯¹è¯ç»Ÿè®¡")):W=le?.length||0,a.value={activeProjects:_,pendingTasks:J,organizations:v.length,aiChats:W},console.log("âœ… ç»Ÿè®¡æ•°æ®åŠ è½½å®Œæˆ:",a.value)}catch(t){console.error("åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥:",t),a.value={activeProjects:0,pendingTasks:0,organizations:0,aiChats:0}}}async function re(){try{const t=l.user?.id,s=l.user?.email;if(!t&&!s){console.log("ç”¨æˆ·IDå’Œé‚®ç®±éƒ½ä¸ºç©ºï¼Œè·³è¿‡æœ€è¿‘é¡¹ç›®åŠ è½½"),c.value=[];return}console.log("ðŸ” å¼€å§‹åŠ è½½æœ€è¿‘é¡¹ç›®ï¼Œè®¤è¯ID:",t,"é‚®ç®±:",s);try{console.log("ðŸ” å°è¯•ç›´æŽ¥åŠ è½½æ‰€æœ‰é¡¹ç›®...");const{data:r,error:o}=await g.from("projects").select("*").order("created_at",{ascending:!1});o?(console.warn("ç›´æŽ¥åŠ è½½é¡¹ç›®å¤±è´¥ï¼Œå°è¯•ç»„ç»‡å…³è”æ–¹å¼:",o.message),await F()):(c.value=(r||[]).slice(0,5),console.log(`âœ… ç›´æŽ¥åŠ è½½æœ€è¿‘é¡¹ç›®æˆåŠŸ: ${c.value.length} ä¸ªé¡¹ç›®`))}catch(r){console.warn("ç›´æŽ¥åŠ è½½é¡¹ç›®å¼‚å¸¸ï¼Œå°è¯•ç»„ç»‡å…³è”æ–¹å¼:",r),await F()}}catch(t){console.error("åŠ è½½æœ€è¿‘é¡¹ç›®å¤±è´¥:",t),c.value=[]}}async function F(){try{const t=await T();if(!t){console.log("æ— æ³•èŽ·å–æ•°æ®åº“ç”¨æˆ·IDï¼Œè·³è¿‡æœ€è¿‘é¡¹ç›®åŠ è½½"),c.value=[];return}console.log("âœ… èŽ·å–åˆ°æ•°æ®åº“ç”¨æˆ·ID:",t);const[{data:s,error:r},{data:o,error:m}]=await Promise.all([g.from("organization_members").select("organization_id").eq("user_id",t),g.from("organizations").select("id").eq("owner_id",t)]);if(r&&m){if(console.error("æŸ¥è¯¢ç»„ç»‡å…³ç³»å¤±è´¥:",r,m),r.message?.includes("does not exist")||m.message?.includes("does not exist")){console.warn("ç»„ç»‡ç›¸å…³è¡¨ä¸å­˜åœ¨ï¼Œè¿”å›žç©ºé¡¹ç›®åˆ—è¡¨"),c.value=[];return}c.value=[];return}const E=s?.map(_=>_.organization_id)||[],z=o?.map(_=>_.id)||[],h=[...new Set([...E,...z])];if(console.log("âœ… ç”¨æˆ·æ‰€å±žç»„ç»‡æ•°é‡:",h.length),h.length===0){c.value=[],console.log("ç”¨æˆ·æ²¡æœ‰ç»„ç»‡ï¼Œè¿”å›žç©ºé¡¹ç›®åˆ—è¡¨");return}const{data:D,error:v}=await g.from("projects").select("*").in("organization_id",h).order("created_at",{ascending:!1}).limit(5);if(v){if(console.error("æŸ¥è¯¢é¡¹ç›®å¤±è´¥:",v),v.message?.includes("does not exist")){console.warn("projectsè¡¨ä¸å­˜åœ¨ï¼Œè¿”å›žç©ºé¡¹ç›®åˆ—è¡¨"),c.value=[];return}c.value=[];return}c.value=D||[],console.log("âœ… æœ€è¿‘é¡¹ç›®åŠ è½½å®Œæˆï¼Œæ•°é‡:",c.value.length)}catch(t){console.error("é€šè¿‡ç»„ç»‡å…³è”åŠ è½½æœ€è¿‘é¡¹ç›®å¤±è´¥:",t),c.value=[]}}async function ae(){try{const t=l.user?.id,s=l.user?.email;if(!t&&!s){console.log("ç”¨æˆ·IDå’Œé‚®ç®±éƒ½ä¸ºç©ºï¼Œè·³è¿‡æ´»è·ƒé¡¹ç›®åŠ è½½"),u.value=[];return}console.log("ðŸ” å¼€å§‹åŠ è½½æ´»è·ƒé¡¹ç›®ï¼Œè®¤è¯ID:",t,"é‚®ç®±:",s);try{console.log("ðŸ” å°è¯•ç›´æŽ¥åŠ è½½æ‰€æœ‰æ´»è·ƒé¡¹ç›®...");const{data:r,error:o}=await g.from("projects").select("*").eq("status","active").order("priority",{ascending:!1}).order("created_at",{ascending:!1});o?(console.warn("ç›´æŽ¥åŠ è½½æ´»è·ƒé¡¹ç›®å¤±è´¥ï¼Œå°è¯•ç»„ç»‡å…³è”æ–¹å¼:",o.message),await G()):(u.value=r||[],console.log(`âœ… ç›´æŽ¥åŠ è½½æ´»è·ƒé¡¹ç›®æˆåŠŸ: ${u.value.length} ä¸ªé¡¹ç›®`))}catch(r){console.warn("ç›´æŽ¥åŠ è½½æ´»è·ƒé¡¹ç›®å¼‚å¸¸ï¼Œå°è¯•ç»„ç»‡å…³è”æ–¹å¼:",r),await G()}}catch(t){console.error("åŠ è½½æ´»è·ƒé¡¹ç›®å¤±è´¥:",t),u.value=[]}}async function G(){try{const t=await T();if(!t){console.log("æ— æ³•èŽ·å–æ•°æ®åº“ç”¨æˆ·IDï¼Œè·³è¿‡æ´»è·ƒé¡¹ç›®åŠ è½½"),u.value=[];return}console.log("âœ… èŽ·å–åˆ°æ•°æ®åº“ç”¨æˆ·ID:",t);const[{data:s,error:r},{data:o,error:m}]=await Promise.all([g.from("organization_members").select("organization_id").eq("user_id",t),g.from("organizations").select("id").eq("owner_id",t)]);if(r&&m){if(console.error("æŸ¥è¯¢ç»„ç»‡å…³ç³»å¤±è´¥:",r,m),r.message?.includes("does not exist")||m.message?.includes("does not exist")){console.warn("ç»„ç»‡ç›¸å…³è¡¨ä¸å­˜åœ¨ï¼Œè¿”å›žç©ºé¡¹ç›®åˆ—è¡¨"),u.value=[];return}u.value=[];return}const E=s?.map(_=>_.organization_id)||[],z=o?.map(_=>_.id)||[],h=[...new Set([...E,...z])];if(console.log("âœ… ç”¨æˆ·æ‰€å±žç»„ç»‡æ•°é‡:",h.length),h.length===0){u.value=[],console.log("ç”¨æˆ·æ²¡æœ‰ç»„ç»‡ï¼Œè¿”å›žç©ºé¡¹ç›®åˆ—è¡¨");return}const{data:D,error:v}=await g.from("projects").select("*").in("organization_id",h).eq("status","active").order("priority",{ascending:!1}).order("created_at",{ascending:!1});if(v){if(console.error("æŸ¥è¯¢æ´»è·ƒé¡¹ç›®å¤±è´¥:",v),v.message?.includes("does not exist")){console.warn("projectsè¡¨ä¸å­˜åœ¨ï¼Œè¿”å›žç©ºé¡¹ç›®åˆ—è¡¨"),u.value=[];return}u.value=[];return}u.value=D||[],console.log("âœ… æ´»è·ƒé¡¹ç›®åŠ è½½å®Œæˆï¼Œæ•°é‡:",u.value.length)}catch(t){console.error("é€šè¿‡ç»„ç»‡å…³è”åŠ è½½æ´»è·ƒé¡¹ç›®å¤±è´¥:",t),u.value=[]}}async function ne(){try{const t=[];a.value.pendingTasks>10&&t.push({id:1,message:`æ£€æµ‹åˆ°æ‚¨æœ‰${a.value.pendingTasks}ä¸ªå¾…åŠžä»»åŠ¡ï¼Œå»ºè®®ä¼˜å…ˆå¤„ç†é«˜ä¼˜å…ˆçº§ä»»åŠ¡`}),a.value.activeProjects>0&&t.push({id:2,message:`æ‚¨æœ‰${a.value.activeProjects}ä¸ªæ´»è·ƒé¡¹ç›®ï¼Œå»ºè®®å®šæœŸæ£€æŸ¥é¡¹ç›®è¿›åº¦`}),a.value.organizations===0&&t.push({id:3,message:"æ‚¨è¿˜æ²¡æœ‰åŠ å…¥ä»»ä½•ç»„ç»‡ï¼Œå»ºè®®å…ˆåˆ›å»ºæˆ–åŠ å…¥ä¸€ä¸ªç»„ç»‡"}),t.length===0&&t.push({id:4,message:"ä¸€åˆ‡è¿è¡Œè‰¯å¥½ï¼å¦‚æœ‰éœ€è¦ï¼Œå¯ä»¥éšæ—¶å’¨è¯¢AIåŠ©æ‰‹"}),b.value=t}catch(t){console.error("ç”ŸæˆAIå»ºè®®å¤±è´¥:",t),b.value=[{id:1,message:"AIå»ºè®®æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åŽé‡è¯•"}]}}async function C(){w.value=!0,f.value="";try{if(!l.user?.id){console.log("ç”¨æˆ·æœªè®¤è¯ï¼Œç­‰å¾…è®¤è¯çŠ¶æ€"),setTimeout(()=>{l.user?.id?C():(w.value=!1,f.value="ç”¨æˆ·æœªè®¤è¯ï¼Œè¯·å…ˆç™»å½•")},2e3);return}console.log("ðŸš€ å¼€å§‹åŠ è½½ä»ªè¡¨ç›˜æ•°æ®ï¼Œç”¨æˆ·ID:",l.user.id),k.value="æ­£åœ¨åˆå§‹åŒ–æ•°æ®åŠ è½½...",await Promise.all([te(),oe(),re(),ae()]),k.value="æ­£åœ¨ç”ŸæˆAIå»ºè®®...",await ne(),console.log("ðŸŽ‰ ä»ªè¡¨ç›˜æ•°æ®åŠ è½½å®Œæˆ:",{ç”¨æˆ·æ¡£æ¡ˆ:p.value?"å·²åŠ è½½":"æœªåŠ è½½",ç»„ç»‡æ•°é‡:V.organizations.length,æ´»è·ƒé¡¹ç›®:a.value.activeProjects,å¾…åŠžä»»åŠ¡:a.value.pendingTasks,AIå¯¹è¯:a.value.aiChats,æœ€è¿‘é¡¹ç›®:c.value.length})}catch(t){console.error("âŒ åŠ è½½ä»ªè¡¨ç›˜æ•°æ®å¤±è´¥:",t),t?.code==="42P17"&&t?.message?.includes("infinite recursion")?(console.warn("æ£€æµ‹åˆ°æ•°æ®åº“ç­–ç•¥é€’å½’é”™è¯¯ï¼Œè¯·æ‰§è¡Œä¿®å¤è„šæœ¬"),f.value="æ£€æµ‹åˆ°æ•°æ®åº“ç­–ç•¥é€’å½’é”™è¯¯ï¼Œè¯·æ‰§è¡Œæ•°æ®åº“ä¿®å¤è„šæœ¬",b.value=[{id:1,message:"æ£€æµ‹åˆ°æ•°æ®åº“ç­–ç•¥é€’å½’é”™è¯¯ï¼Œè¯·æ‰§è¡Œä¿®å¤è„šæœ¬"}]):t?.message?.includes("JWT")?(console.warn("è®¤è¯ä»¤ç‰Œå¤±æ•ˆï¼Œè¯·é‡æ–°ç™»å½•"),f.value="è®¤è¯ä»¤ç‰Œå¤±æ•ˆï¼Œè¯·é‡æ–°ç™»å½•",b.value=[{id:1,message:"è®¤è¯ä»¤ç‰Œå¤±æ•ˆï¼Œè¯·é‡æ–°ç™»å½•"}]):t?.message?.includes("does not exist")?f.value="æ•°æ®åº“è¡¨ä¸å­˜åœ¨ï¼Œè¯·å…ˆæ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬":f.value=`æ•°æ®åŠ è½½å¤±è´¥: ${t.message}`,a.value={activeProjects:0,pendingTasks:0,organizations:0,aiChats:0},c.value=[],b.value.length===0&&(b.value=[{id:1,message:"æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿žæŽ¥æˆ–æ•°æ®åº“é…ç½®"}])}finally{w.value=!1,k.value=""}}return K(()=>l.user?.id,t=>{t&&(console.log("æ£€æµ‹åˆ°ç”¨æˆ·IDå˜åŒ–ï¼Œé‡æ–°åŠ è½½æ•°æ®:",t),C())}),K(()=>P.currentRoute.value.path,t=>{t==="/"&&l.user?.id&&(console.log("æ£€æµ‹åˆ°è·¯ç”±å˜åŒ–åˆ°ä»ªè¡¨ç›˜ï¼Œåˆ·æ–°æ•°æ®"),C())}),de(async()=>{await C()}),(t,s)=>{const r=ce("RouterLink");return d(),i("div",pe,[w.value?(d(),i("div",he,[e("div",_e,[s[0]||(s[0]=e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"},null,-1)),s[1]||(s[1]=e("p",{class:"text-gray-600"},"æ­£åœ¨åŠ è½½ä»ªè¡¨ç›˜æ•°æ®...",-1)),k.value?(d(),i("p",ye,n(k.value),1)):x("",!0)])])):x("",!0),f.value?(d(),i("div",be,[e("div",we,[s[2]||(s[2]=e("svg",{class:"w-5 h-5 text-red-400 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),e("span",ke,n(f.value),1),e("button",{onClick:Y,class:"ml-4 text-sm bg-red-100 hover:bg-red-200 text-red-700 px-3 py-1 rounded"}," é‡è¯• ")])])):x("",!0),e("nav",ze,[e("div",Ie,[e("div",je,[e("div",Ce,[s[6]||(s[6]=e("h1",{class:"text-xl font-semibold text-gray-900"},"AIé¡¹ç›®ç®¡ç†å¹³å°",-1)),e("div",De,[A(r,{to:"/",class:"text-blue-600 font-medium border-b-2 border-blue-600"},{default:O(()=>[...s[3]||(s[3]=[M(" ä»ªè¡¨ç›˜ ",-1)])]),_:1}),A(r,{to:"/project-management",class:"text-gray-700 hover:text-blue-600 font-medium"},{default:O(()=>[...s[4]||(s[4]=[M(" é¡¹ç›®ç®¡ç† ",-1)])]),_:1}),A(r,{to:"/organizations",class:"text-gray-700 hover:text-blue-600 font-medium"},{default:O(()=>[...s[5]||(s[5]=[M(" ç»„ç»‡ç®¡ç† ",-1)])]),_:1})])]),e("div",Pe,[e("div",Ee,[e("img",{src:Q.value,class:"w-8 h-8 rounded-full",alt:"ç”¨æˆ·å¤´åƒ"},null,8,Me),e("span",Ae,n(H.value),1),U.value?(d(),i("span",Oe,n(U.value),1)):x("",!0)]),e("button",{onClick:X,class:"btn btn-outline text-sm"}," é€€å‡ºç™»å½• "),e("button",{onClick:$,class:"btn btn-outline text-sm",disabled:w.value},[(d(),i("svg",{class:q(["w-4 h-4 mr-1",{"animate-spin":w.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...s[7]||(s[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2)),s[8]||(s[8]=M(" åˆ·æ–° ",-1))],8,Se)])])])]),e("main",Te,[e("div",Be,[e("h2",Le,"æ¬¢è¿Žå›žæ¥ï¼Œ"+n(H.value)+"ï¼",1),s[9]||(s[9]=e("p",{class:"text-gray-600"},"AIåŠ©æ‰‹å·²å‡†å¤‡å°±ç»ªï¼Œéšæ—¶ä¸ºæ‚¨æä¾›é¡¹ç›®ç®¡ç†æ”¯æŒ",-1))]),e("div",qe,[e("div",Re,[e("div",Ne,[s[11]||(s[11]=e("div",{class:"p-3 rounded-full bg-blue-100 text-blue-600 mr-4"},[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})])],-1)),e("div",null,[s[10]||(s[10]=e("p",{class:"text-sm font-medium text-gray-600"},"æ´»è·ƒé¡¹ç›®",-1)),e("p",Ve,n(a.value.activeProjects),1),a.value.activeProjects===0?(d(),i("p",He,"æš‚æ— æ´»è·ƒé¡¹ç›®")):x("",!0)])])]),e("div",Ue,[e("div",$e,[s[13]||(s[13]=e("div",{class:"p-3 rounded-full bg-orange-100 text-orange-600 mr-4"},[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})])],-1)),e("div",null,[s[12]||(s[12]=e("p",{class:"text-sm font-medium text-gray-600"},"å¾…åŠžä»»åŠ¡",-1)),e("p",Fe,n(a.value.pendingTasks),1),a.value.pendingTasks===0?(d(),i("p",Ge,"æš‚æ— å¾…åŠžä»»åŠ¡")):x("",!0)])])]),e("div",Je,[e("div",We,[s[15]||(s[15]=e("div",{class:"p-3 rounded-full bg-green-100 text-green-600 mr-4"},[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})])],-1)),e("div",null,[s[14]||(s[14]=e("p",{class:"text-sm font-medium text-gray-600"},"ç»„ç»‡æ•°é‡",-1)),e("p",Ke,n(a.value.organizations),1),a.value.organizations===0?(d(),i("p",Qe,'ç‚¹å‡»"åˆ›å»ºæ–°ç»„ç»‡"å¼€å§‹')):x("",!0)])])]),e("div",Xe,[e("div",Ye,[s[17]||(s[17]=e("div",{class:"p-3 rounded-full bg-purple-100 text-purple-600 mr-4"},[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})])],-1)),e("div",null,[s[16]||(s[16]=e("p",{class:"text-sm font-medium text-gray-600"},"AIå¯¹è¯",-1)),e("p",Ze,n(a.value.aiChats),1),a.value.aiChats===0?(d(),i("p",es,'ç‚¹å‡»"å’¨è¯¢AIåŠ©æ‰‹"å¼€å§‹')):x("",!0)])])])]),!w.value&&!f.value?(d(),i("div",ss,[e("div",{class:"flex items-center justify-between bg-green-50 border border-green-200 rounded-lg p-4"},[s[18]||(s[18]=e("div",{class:"flex items-center"},[e("svg",{class:"w-5 h-5 text-green-500 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})]),e("span",{class:"text-green-700"},"æ•°æ®åº“è¿žæŽ¥æ­£å¸¸ï¼Œæ•°æ®å·²åŠ è½½å®Œæˆ")],-1)),e("button",{onClick:$,class:"text-green-600 hover:text-green-800 text-sm"}," åˆ·æ–°æ•°æ® ")])])):x("",!0),e("div",ts,[e("div",os,[e("div",rs,[e("div",as,[s[20]||(s[20]=e("h3",{class:"text-lg font-semibold text-gray-900"},"æœ€è¿‘é¡¹ç›®",-1)),A(r,{to:"/project-management",class:"text-blue-600 hover:text-blue-700 text-sm font-medium"},{default:O(()=>[...s[19]||(s[19]=[M(" æŸ¥çœ‹å…¨éƒ¨ ",-1)])]),_:1})]),e("div",ns,[(d(!0),i(R,null,N(c.value,o=>(d(),i("div",{key:o.id,class:"p-4 border border-gray-200 rounded-lg hover:border-blue-300 transition-colors"},[e("div",ls,[e("h4",is,n(o.name),1),e("span",{class:q(["px-2 py-1 rounded-full text-xs font-medium",o.status==="active"?"bg-green-100 text-green-800":o.status==="completed"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"])},n(o.status==="active"?"è¿›è¡Œä¸­":o.status==="completed"?"å·²å®Œæˆ":"è§„åˆ’ä¸­"),3)]),e("p",ds,n(o.description),1),e("div",cs,[e("span",null,"è¿›åº¦: "+n(o.progress_percentage)+"%",1),e("span",null,"åˆ›å»º: "+n(S(o.created_at)),1)])]))),128)),c.value.length===0?(d(),i("div",us,[...s[21]||(s[21]=[e("p",null,"æš‚æ— é¡¹ç›®æ•°æ®",-1)])])):x("",!0)])]),e("div",gs,[e("div",ms,[s[22]||(s[22]=e("h3",{class:"text-lg font-semibold text-gray-900"},"æ‰€æœ‰æ´»è·ƒé¡¹ç›®",-1)),e("span",vs,n(u.value.length)+" ä¸ªé¡¹ç›®",1)]),e("div",fs,[(d(!0),i(R,null,N(u.value,o=>(d(),i("div",{key:o.id,class:"p-4 border border-gray-200 rounded-lg hover:border-green-300 transition-colors"},[e("div",xs,[e("h4",ps,n(o.name),1),e("div",hs,[s[23]||(s[23]=e("span",{class:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"}," æ´»è·ƒä¸­ ",-1)),e("span",{class:q(["px-2 py-1 rounded-full text-xs font-medium",o.priority==="urgent"?"bg-red-100 text-red-800":o.priority==="high"?"bg-orange-100 text-orange-800":o.priority==="medium"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"])},n(o.priority==="urgent"?"ç´§æ€¥":o.priority==="high"?"é«˜":o.priority==="medium"?"ä¸­":"ä½Ž"),3)])]),e("p",_s,n(o.description),1),e("div",ys,[e("div",bs,[e("div",ws,[e("div",{class:"bg-green-600 h-2 rounded-full",style:ge({width:o.progress_percentage+"%"})},null,4)])]),e("div",ks,[e("span",null,n(o.progress_percentage)+"%",1)])]),e("div",zs,[e("span",null,"å¼€å§‹: "+n(S(o.start_date||o.created_at)),1),o.end_date?(d(),i("span",Is,"æˆªæ­¢: "+n(S(o.end_date)),1)):x("",!0)])]))),128)),u.value.length===0?(d(),i("div",js,[...s[24]||(s[24]=[e("p",null,"æš‚æ— æ´»è·ƒé¡¹ç›®",-1)])])):x("",!0)])])]),e("div",Cs,[e("div",{class:"card p-6"},[s[25]||(s[25]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"å¿«é€Ÿæ“ä½œ",-1)),e("div",{class:"space-y-3"},[e("button",{onClick:ee,class:"btn btn-primary w-full justify-center"}," åˆ›å»ºæ–°ç»„ç»‡ "),e("button",{onClick:se,class:"btn btn-secondary w-full justify-center"}," åˆ›å»ºæ–°é¡¹ç›® "),e("button",{onClick:Z,class:"btn btn-outline w-full justify-center"}," å’¨è¯¢AIåŠ©æ‰‹ ")])]),e("div",Ds,[s[26]||(s[26]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"AIæ™ºèƒ½å»ºè®®",-1)),e("div",Ps,[(d(!0),i(R,null,N(b.value,o=>(d(),i("div",{key:o.id,class:"p-3 bg-blue-50 rounded-lg"},[e("p",Es,n(o.message),1)]))),128))])])])])])])}}}),Bs=xe(Ms,[["__scopeId","data-v-1b56fc3d"]]);export{Bs as default};
