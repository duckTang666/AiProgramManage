# Dashboard页面使用指南

## 🎯 功能概述

Dashboard页面是AI项目管理平台的主界面，提供以下核心功能：

### 📊 数据统计卡片
- **活跃项目**：显示用户当前参与的所有活跃项目数量
- **待办任务**：统计所有项目中待完成的任务数量
- **组织数量**：显示用户所属的组织数量
- **AI对话**：记录用户与AI助手的对话次数

### 📋 最近项目列表
- 显示用户最近创建的5个项目
- 包含项目状态、描述和创建时间
- 支持快速跳转到项目管理页面

### ⚡ 快速操作
- **创建新组织**：快速创建新的工作组织
- **创建新项目**：在现有组织中创建新项目
- **咨询AI助手**：启动AI聊天助手

### 🤖 AI智能建议
- 基于用户数据生成个性化建议
- 提供项目管理优化建议
- 智能提醒重要事项

## 🔧 数据库连接配置

### 1. 环境变量设置
确保 `.env` 文件包含正确的Supabase配置：

```env
VITE_SUPABASE_URL=你的Supabase项目URL
VITE_SUPABASE_ANON_KEY=你的Supabase匿名密钥
```

### 2. 数据库表结构
Dashboard页面需要以下数据库表：
- `user_profiles` - 用户档案
- `organizations` - 组织信息
- `organization_members` - 组织成员关系
- `projects` - 项目信息
- `tasks` - 任务信息
- `chat_history` - AI对话记录

### 3. 执行数据库设置
运行以下命令设置数据库：

```bash
# 执行数据库设置脚本
node setup-dashboard-database.js
```

## 🚀 快速开始

### 步骤1: 数据库初始化
1. 登录 [Supabase Dashboard](https://supabase.com/dashboard)
2. 选择你的项目
3. 进入 SQL Editor
4. 执行 `dashboard-database-setup.sql` 脚本

### 步骤2: 启动应用
```bash
npm run dev
```

### 步骤3: 测试功能
1. 注册新用户或使用现有用户登录
2. 访问 Dashboard 页面
3. 检查数据是否正确加载

## 📊 数据加载流程

### 认证检查
```javascript
// 检查用户认证状态
if (!authStore.user?.id) {
  console.log('用户未认证，等待认证状态');
  return;
}
```

### 组织数据加载
```javascript
// 加载用户所属的组织
await organizationStore.fetchOrganizations(authStore.user.id);
```

### 项目数据统计
```javascript
// 遍历所有组织，统计项目数据
for (const org of organizationStore.organizations) {
  await projectStore.fetchProjects(org.id);
  // 统计活跃项目和待办任务
}
```

### AI建议生成
```javascript
// 基于统计数据生成智能建议
if (stats.value.pendingTasks > 10) {
  suggestions.push({
    message: `检测到您有${stats.value.pendingTasks}个待办任务，建议优先处理高优先级任务`
  });
}
```

## 🔍 故障排除

### 常见问题1: 数据加载失败
**症状**: Dashboard页面显示空白或默认数据
**解决方案**:
1. 检查浏览器控制台错误信息
2. 验证Supabase连接配置
3. 检查数据库策略设置

### 常见问题2: 策略递归错误
**症状**: 控制台显示 "42P17" 错误代码
**解决方案**:
1. 执行 `fix-database-policies.sql` 脚本
2. 重新加载页面

### 常见问题3: 用户档案未找到
**症状**: 登录成功但用户信息显示异常
**解决方案**:
1. 检查用户注册流程
2. 验证 `handle_new_user` 触发器
3. 手动创建用户档案

## 📈 性能优化建议

### 1. 数据缓存
- 使用Pinia存储管理状态
- 实现数据缓存机制
- 减少不必要的API调用

### 2. 懒加载
- 分页加载项目列表
- 按需加载任务数据
- 优化图片和资源加载

### 3. 错误处理
- 完善的错误边界处理
- 友好的用户提示
- 自动重试机制

## 🔄 数据更新机制

### 实时更新
- 使用Supabase实时订阅功能
- 监听数据变更事件
- 自动刷新界面

### 手动刷新
- 提供刷新按钮
- 支持下拉刷新
- 定时自动刷新

## 🎨 界面定制

### 主题配置
- 支持明暗主题切换
- 自定义颜色方案
- 响应式布局适配

### 布局调整
- 可调整卡片位置
- 支持自定义视图
- 个性化设置保存

## 📱 移动端适配

### 响应式设计
- 适配各种屏幕尺寸
- 触摸友好的交互
- 移动端专属功能

### 离线支持
- PWA应用支持
- 离线数据缓存
- 同步机制

## 🔒 安全考虑

### 数据权限
- 基于角色的访问控制
- 行级安全策略
- 数据隔离保护

### 认证安全
- JWT令牌管理
- 会话超时处理
- 安全退出机制

## 📚 扩展功能

### 插件系统
- 支持功能插件扩展
- 第三方服务集成
- 自定义组件开发

### API接口
- 开放的REST API
- Webhook支持
- 数据导出功能

---

## 💡 使用技巧

1. **快速导航**: 使用快捷键快速访问不同功能
2. **数据筛选**: 使用筛选器快速找到特定项目
3. **批量操作**: 支持多选和批量操作
4. **搜索功能**: 全局搜索支持快速定位

## 🆘 技术支持

如果遇到问题，请：
1. 检查本文档的故障排除部分
2. 查看浏览器控制台错误信息
3. 联系技术支持团队
4. 提交问题报告

---

**版本**: 1.0.0  
**最后更新**: 2024-01-01  
**维护团队**: AI项目管理平台开发团队