# AI项目管理平台 - 数据库数据生成指南

## 概述

本文档指导您如何为AI项目管理平台生成数据库数据，并在前端页面中显示这些数据。

## 文件结构

```
AiProgramManage/
├── supabase-init.sql          # 数据库表结构初始化脚本
├── supabase-mock-data.sql     # 模拟数据插入脚本
├── scripts/
│   └── init-database.js       # 数据库初始化脚本
└── src/
    ├── lib/
    │   ├── supabase.ts        # Supabase客户端配置
    │   └── database.ts        # 数据库服务类
    └── views/
        └── DataDisplay.vue     # 数据展示页面
```

## 数据库初始化步骤

### 方法一：使用Supabase Dashboard（推荐）

1. **登录Supabase控制台**
   - 访问：https://supabase.com/dashboard/project/pgnjxsvtxrqsuukadlzu
   - 使用项目凭据登录

2. **执行数据库初始化脚本**
   - 进入左侧菜单的 "SQL Editor"
   - 复制 `supabase-init.sql` 文件内容
   - 粘贴到SQL编辑器中并执行
   - 等待表创建完成

3. **插入模拟数据**
   - 复制 `supabase-mock-data.sql` 文件内容
   - 在SQL编辑器中执行
   - 验证数据插入成功

### 方法二：使用Node.js脚本

1. **安装依赖**
   ```bash
   cd AiProgramManage
   npm install @supabase/supabase-js
   ```

2. **运行初始化脚本**
   ```bash
   node scripts/init-database.js
   ```

3. **验证初始化结果**
   - 脚本会自动验证表创建和数据插入
   - 查看控制台输出确认成功

## 前端数据展示

### 访问数据展示页面

1. **启动开发服务器**
   ```bash
   npm run dev
   ```

2. **访问数据展示页面**
   - 打开浏览器访问：http://localhost:5173/data-display
   - 或者从仪表盘导航到"数据展示"页面

### 页面功能说明

数据展示页面包含以下功能：

- **统计概览**：显示用户、组织、项目、任务的总数
- **用户列表**：显示所有用户信息，包括头像、姓名、邮箱和角色
- **项目列表**：显示项目基本信息，包括状态、进度和优先级
- **任务列表**：显示任务详情，包括状态、截止时间和预估工时
- **AI对话记录**：显示AI助手与用户的对话历史
- **实时刷新**：支持手动刷新数据
- **错误处理**：显示数据库连接错误和提示信息

## 数据库表结构

### 核心数据表

1. **users（用户表）**
   - 存储平台用户信息
   - 包含角色、头像、状态等字段

2. **organizations（组织表）**
   - 存储组织/团队信息
   - 与用户通过organization_members关联

3. **projects（项目表）**
   - 存储项目基本信息
   - 包含状态、优先级、进度等字段

4. **tasks（任务表）**
   - 存储项目任务信息
   - 包含分配人、状态、截止时间等字段

5. **chat_history（AI对话历史表）**
   - 存储用户与AI助手的对话记录
   - 支持按项目和组织分类

### 关联关系

- 用户 ↔ 组织（多对多，通过organization_members）
- 用户 ↔ 项目（多对多，通过project_members）
- 组织 ↔ 项目（一对多）
- 项目 ↔ 任务（一对多）

## 模拟数据内容

### 用户数据（8个用户）
- 1个系统管理员
- 3个项目经理
- 4个团队成员（开发、设计、测试、产品）

### 组织数据（3个组织）
- AI技术研发中心
- 产品创新事业部
- 数据智能实验室

### 项目数据（6个项目）
- 智能客服系统开发（进行中，75%）
- 数据分析平台重构（进行中，60%）
- 移动端应用开发（规划中，20%）
- 机器学习模型优化（进行中，85%）
- UI组件库建设（已完成，100%）
- 自动化测试框架（进行中，45%）

### 任务数据（13个任务）
- 涵盖不同状态：待办、进行中、已完成
- 包含不同优先级：低、中、高、紧急

### AI对话记录（8条记录）
- 包含问题、建议、分析等类型
- 涉及项目管理、技术咨询等主题

## 常见问题解决

### 问题1：数据库连接失败

**症状**：页面显示"数据库连接失败"错误

**解决方案**：
1. 检查 `.env` 文件中的Supabase配置
2. 验证网络连接
3. 检查Supabase项目状态

### 问题2：表不存在错误

**症状**：页面显示"数据库表不存在"错误

**解决方案**：
1. 执行 `supabase-init.sql` 脚本
2. 验证表是否成功创建
3. 检查表名拼写是否正确

### 问题3：数据不显示

**症状**：页面加载但数据显示为空

**解决方案**：
1. 检查 `supabase-mock-data.sql` 是否执行成功
2. 验证数据插入是否成功
3. 检查浏览器控制台错误信息

### 问题4：认证错误

**症状**：页面显示"认证令牌失效"错误

**解决方案**：
1. 重新登录系统
2. 检查用户认证状态
3. 清除浏览器缓存

## 开发说明

### 数据库服务类

`src/lib/database.ts` 包含以下服务类：

- `UserService`：用户数据操作
- `OrganizationService`：组织数据操作
- `ProjectService`：项目数据操作
- `TaskService`：任务数据操作
- `ChatService`：AI对话记录操作
- `DashboardService`：仪表盘数据统计

### 数据展示组件

`src/views/DataDisplay.vue` 组件特性：

- 响应式设计，支持移动端
- 实时数据加载和错误处理
- 支持数据刷新和重试
- 友好的加载状态和空状态提示

## 后续扩展

### 数据可视化
- 添加图表展示项目进度
- 实现任务状态分布图
- 添加时间线视图

### 数据导出
- 支持数据导出为Excel/CSV
- 添加打印功能
- 实现数据报表生成

### 权限控制
- 基于角色的数据访问控制
- 组织级别的数据隔离
- 项目级别的权限管理

## 技术支持

如遇到问题，请参考：

1. **Supabase官方文档**：https://supabase.com/docs
2. **Vue 3官方文档**：https://vuejs.org/
3. **项目README文档**：查看项目根目录的README.md

---

**最后更新**：2024年10月29日  
**版本**：v1.0.0